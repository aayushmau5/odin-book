datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id               String    @id @default(uuid())
  username         String
  email            String    @unique
  password         String
  profile          Profile?  @relation("profile")
  friends          Profile[] @relation("friends")
  incoming_friends Profile[] @relation("incoming_friends")
  outgoing_friends Profile[] @relation("outgoing_friends")
  createdAt        DateTime  @default(now())

  @@map("users")
}

model Profile {
  id               String @id @default(uuid())
  firstname        String
  lastname         String
  display          String
  friends          User[] @relation("friends")
  incoming_friends User[] @relation("incoming_friends")
  outgoing_friends User[] @relation("outgoing_friends")
  posts            Post[]
  likes            Post[] @relation("likes")
  user             User   @relation("profile", fields: [userId], references: [id])
  userId           String

  @@map("profiles")
}

model Post {
  id        String    @id @default(uuid())
  data      String
  createdAt DateTime  @default(now())
  author    Profile   @relation(fields: [authorId], references: [id])
  authorId  String
  likes     Profile[] @relation("likes")
  comments  Comment[]

  @@map("posts")
}

model Comment {
  id        String    @id @default(uuid())
  data      String
  createdAt DateTime  @default(now())
  post      Post      @relation(fields: [postId], references: [id])
  postId    String
  comments  Comment[] @relation("CommentToComment")

  Comment Comment[] @relation("CommentToComment")
  @@map("comments")
}
